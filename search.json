[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Notes on Longitudinal Data Analysis for Epidemiology",
    "section": "",
    "text": "Welcome"
  },
  {
    "objectID": "intro.html#longitudinal-studies",
    "href": "intro.html#longitudinal-studies",
    "title": "1  State of the Art - Statistics",
    "section": "1.1 Longitudinal studies",
    "text": "1.1 Longitudinal studies\n\nLongitudinal studies are defined as studies in which the outcome variable is repeateadly measured; i.e. the outcome variable is measured in the same subject on several occasions. – Extracted from Twisk (2013)\n\nCharacteristics:\n\nObservations of one subject over time are not independent of each other.\nStatistics should consider that repeated observations of each subject are correlated.\nThis studies bring the illusion than are solving causality but only we can try temporality.\n\n\nStatistical notation\n\n\n\nNotation\n\n\n\n\nnumber of subjects\ni = 1 to N\n\n\nnumber of covariates\nj = 1 to J\n\n\nnumber of times a particular subject is measured\nt = 1 to T\n\n\noutcome variable\nY\n\n\ncovariates\nX\n\n\n\n\n\n\nImage extracted from Twisk (2013)"
  },
  {
    "objectID": "intro.html#cohort-studies",
    "href": "intro.html#cohort-studies",
    "title": "1  State of the Art - Statistics",
    "section": "1.2 Cohort studies",
    "text": "1.2 Cohort studies\n\n1.2.1 Observational cohort studies\nThe question of probable causality remains unanswered.\ncan be divided into:\n* prospective. * The only one that can be characterized as longitudinal.\n* Analyze the longitudinal development of a certain characteristic over time (growth or deterioration).\n* tracking: “stability” of a certain characteristic over time.\n\nretrospective.\ncross-sectional.\n\n\n\n\nTerm\nDefinition\n\n\n\n\nage\ntime from date of birth to date of measurement\n\n\nperiod\ntime or moment at which the measurement is taken\n\n\nbirth cohort\ngroup of subjects born in the same year\n\n\n\n\n1.2.1.1 Confounding Effects\nage, period and cohort effects could produce variations in the results.\n\nperiod effect.\nIf we measure physical activity during summers, it is likely that we can have more physical activity a hot summer than a rainy one. This can produce a bias in the age trend.\ncohort effect. If we want to unify results for the same age for cohorts that start at different ages, we will find that the trend is much flatter than the effects of the cohorts in isolation.\n\nOne way to avoid the bias is to use an approach called multiple longitudinal design Basically, multiple longitudinal design is to work with more than one cohort at the same time. If all the cohorts show a defined pattern for a particular measure in time, we will be able to detect it with this approach.\n\nTest or learning effect. Individuals start performing better with exposure.\nLow reproducibility of the measurements. Inter-period correlation coefficients (IPCs) (van ’t Hofand Kowalski, 1979)\n\n\n\n\n1.2.2 Experimental cohort studies (clinical trials)\n\nThere are prospective (ie longitudinal).\nThe outcome variable Y is measured at least twice (the classical “pre-test,” “post-test” design).\nThe issue of causality can be covered"
  },
  {
    "objectID": "intro.html#one-continous-outcome-variable-y-is-repeatedly-measured-over-time",
    "href": "intro.html#one-continous-outcome-variable-y-is-repeatedly-measured-over-time",
    "title": "1  State of the Art - Statistics",
    "section": "1.3 One continous outcome variable Y is repeatedly measured over time",
    "text": "1.3 One continous outcome variable Y is repeatedly measured over time\n\n1.3.1 Two measurements\n\n1.3.1.1 Parametric: paired t-test\n\nIs there a difference in the outcome variable Y between t = 1 and t = 2?\n\nThe paired t-test is used to test the hypothesis that the mean difference between Yt1 and Yt2 equals zero.\n\nObservations within one individual are dependent on each other.\nUse if the number of subjects is quite large (say above 25).\n\n\n1.3.1.1.1 Assumptions\n1 - The observations of different subjects are independent and;\n2 - The differences between the two measurements are approximately normally distributed.\n\n\n\n1.3.1.2 Non-parametric: (Wilcoxon) signed rank sum\nDoesn’t assume any distribution.\n\n\n\n1.3.2 More than two measurements\n\nDoes the outcome variable Y change over time?\n\n\n\n1.3.3 Multivariate analysis of variance (MANOVA) for repeated measurements\n1 - Observations of different subjects. at each of the repeated measurements need to be independent; and. 2 - The observations need to be multivariate normally distributed, which is comparable but slightly more restrictive than the requirement that the differences between subsequent measurements be normally distributed.\n\n1.3.3.1 ANOVA (univariate) vs. MANOVA (multivariate)\nTo perform an ANOVA there is one extra assumption with 2 parts:\nSphericity assumption (epsilon coefficient)\n3 - All correlations in outcome variable Y between repeated measurements are equal, irrespective of the time interval between the measurements.\n4 - The variances of outcome variable Y are the same at each of the repeated measurements.\nWhich approach should be used? If the assumptions are met, ANOVA is more powerful for smaller samples:\n\n“The restriction of the assumption of sphericity (i.e. equal correlations and equal variances over time) leads to an increase in degrees of freedom, i.e. an increase in power for the “univariate” approach. This increase in power becomes more important when the sample size becomes smaller. Historically, the “multivariate” approach was developed later than the “univariate” approach, especially for situations when the assumption of sphericity does not hold. So, one could argue that when the assumption of sphericity is violated, the “multivariate” approach should be used.\n\n– Extracted from Twisk (2013)\nMAMOVA in R - https://www.appsilon.com/post/manova-in-r"
  },
  {
    "objectID": "intro.html#one-continuous-outcome-variable-y-is-compared-between-different-groups.",
    "href": "intro.html#one-continuous-outcome-variable-y-is-compared-between-different-groups.",
    "title": "1  State of the Art - Statistics",
    "section": "1.4 One continuous outcome variable Y is compared between different groups.",
    "text": "1.4 One continuous outcome variable Y is compared between different groups.\nThis design is known as the “one-within, one-between” design. Time is the within-subject factor and the group variable is the between-subjects factor.\n\nIs there a difference in change over time for outcome variable Y between two or more groups?\n\n\nThis question can also be answered with MANOVA for repeated measurements if it is assumed that the covariance matrices of the different groups that are compared to each other are homogeneous (independent sample t-test).\nApparently, MANOVA could be biased when you have a lot of drop-offs in the study (Everitt (1998))."
  },
  {
    "objectID": "intro.html#continuous-outcome-variable-and-several-covariates",
    "href": "intro.html#continuous-outcome-variable-and-several-covariates",
    "title": "1  State of the Art - Statistics",
    "section": "1.5 Continuous outcome variable and several covariates",
    "text": "1.5 Continuous outcome variable and several covariates\n(which can be either continuous, dichotomous, or categorical)\n\n“traditional” methods tried to reduce the statistical longitudinal problem into a cross-sectional problem.\n\n\n1.5.1 Traditional methods.\n\nAnalysis of the relationships between changes in different parameters between two points in time. (but, you are not using all the data)\nUse individual regression lines with time.\n\n\n\n1.5.2 New methods.\nWith the development of (new) statistical techniques, such as:\n\nGeneralized estimating equations (GEE) analysis and;\nMixed-model analysis,\n\nit has become possible to analyze longitudinal relationships using all available longitudinal data, without summarizing the longitudinal development of each subject into one value.\nCrippa (2022) A review of Longitudinal Data Analysis in R: https://rpubs.com/alecri/review_longitudinal\n\nIn this model the coefficients of interest are β1j, because these regression coefficients show the magnitude of the longitudinal relationship between the outcome variable (Yit) and the covariates (Xijt).\nBecause of the dependency of the repeated observations within one subject, the relationship between X and Y must be adjusted for the subject. There is one by subject and are represented by dummy variables.\n\n\n1.5.2.1 GEE\n\nBefore carrying out a GEE analysis, the within-subject correlation structure must be chosen.\nIn the literature it is assumed that GEE analysis is robust against a wrong choice of the correlation structure. However, this is only the case when there are no missing data and when the model correctly specifies the mean.\nThe interpretation of β1 is more complex than in a cross-sectional analysis.\n\n\n\n1.5.2.2 Mixed Models\n\nThis type of study design is characterized by a hierarchical structure. In longitudinal studies observations within one subject over time are correlated. The observations over time are nested within the subject.\nThe way mixed model analysis adjusts for the subject is different from the way GEE analysis adjusts for the subject.\nwhen an adjustment is made for the subject (i.e. the id_number), for each subject different intercepts are calculated.\nThe first step within a mixed model analysis is therefore to draw a normal distribution around the intercepts and in the second step the variance of that normal distribution is estimated.\nThat variance is added to the longitudinal regression model in order to adjust for the subject in an efficient way.\nBecause this variance is known as the random intercept (β0i), mixed model analysis is also known as random coefficient analysis.\nThe general idea behind a mixed model analysis is that the unexplained variance in outcome variable Y is divided into different components. One of the components is related to the random intercept and another component is related to random slopes.\n\nA model with a random intercept allows the intercepts to differ between the subjects, but the regression coefficient for the covariate X is the same for all the subjects. In a longitudinal study it is not uncommon that besides the intercepts also the regression coefficients for X differ between the subjects\nWhen regression coefficients for X differ between subjects, there is an interaction between the covariate X and the subject. As for the adjustment for the subject, also the interaction with the subject has to be added to a cross-sectional regression model with dummy variables."
  },
  {
    "objectID": "intro.html#gamm",
    "href": "intro.html#gamm",
    "title": "1  State of the Art - Statistics",
    "section": "1.6 GAMM",
    "text": "1.6 GAMM\n\ngamm considers that the observations aren’t independent (not the same as gam)\n\n\n1.6.1 Random Effects\nAs we saw in the section about changing the basis, bs specifies the type of underlying base function. For random intercepts and linear random slopes we use bs = \"re\", but for random smooths we use bs = \"fs\".\n3 different types of random effects in GAMMs (fac factor coding for the random effect; x0 continuous fixed effect):\n\nrandom intercepts adjust the height of other model terms with a constant value: s(fac, bs = \"re\")\nrandom slopes adjust the slope of the trend of a numeric predictor: s(fac, x0, bs = \"re\")\nrandom smooths adjust the trend of a numeric predictor in a nonlinear way: s(x0, fac, bs = \"fs\", m = 1), where the argument m=1 sets a heavier penalty for the smooth moving away from 0, causing shrinkage to the mean.\n\nhttps://stats.stackexchange.com/questions/391912/how-to-fit-a-longitudinal-gam-mixed-model-gamm\nhttps://jacolienvanrij.com/Tutorials/GAMM.html#setting-up-a-gamm-model https://r.qcbs.ca/workshop08/pres-en/workshop08-pres-en.html#129 https://r.qcbs.ca/workshop08/book-en/introduction-to-gams.html https://bart-larsen.github.io/GAMM-Tutorial/\n\nWe can try to build a more appropriate model by fitting the data with a smoothed (non-linear) term specified by expressions of the form s(x)\nRadj is the variance explained by the model\n\n\n\n\n\nEveritt, BS. 1998. “Analysis of Longitudinal Data: Beyond MANOVA.” The British Journal of Psychiatry 172 (1): 7–10.\n\n\nTwisk, Jos W. R. 2013. Applied Longitudinal Data Analysis for Epidemiology: A Practical Guide. 2nd ed. Cambridge University Press."
  },
  {
    "objectID": "papers.html#general-additive-mixed-model-gamm",
    "href": "papers.html#general-additive-mixed-model-gamm",
    "title": "2  Scientific articles",
    "section": "2.1 General Additive Mixed Model (GAMM)",
    "text": "2.1 General Additive Mixed Model (GAMM)\nsemi-parametric model\nLet’s start with an equation for a Gaussian linear model:\ny=β0+x1β1+ε,ε∼N(0,σ2)\nWhat changes in a GAM is the presence of a smoothing term:\ny=β0+f(x1)+ε,ε∼N(0,σ2)\nThis term could be many things.\n\n2.1.1 Walking speed and age\nFixed Effects Predictors.\n\nage.\nheight.\n\nRandom Effect.\n\nstudy at the intercept and age slope.\n\n\n\n2.1.2 Number of years of functioning lost (primary outcome)\nIt is based on the predictions of the previous model.\nFixed Effects\n\nage.\nage2.\nheight.\nyear of birth.\ndistances walked.\n\nrisk factor under study (minimally adjusted model).\nall risk factors (mutually adjusted models).\n\nCI - Model based parametric 5000 bootstrap samples\n\n\n2.1.3 Years of life lost (secundary outcome)\nDifference between the areas of the survival curves.\nSurvival curves Kaplan-Meier adjusted curves, conditional on survival to age 60 years. They run a shared frality Cox model with age as time scale, stratified by the levels of the given risk factor and a year of birth as covariate (for minimally adjusted models) or year of birth and the remaining risk factors as covariates (mutually adjusted models)\nschrempft 2022"
  },
  {
    "objectID": "papers.html#pace-of-aging",
    "href": "papers.html#pace-of-aging",
    "title": "2  Scientific articles",
    "section": "2.2 Pace of aging",
    "text": "2.2 Pace of aging\nsimilar to Dunedin Study investigators\n1 - Biomarkers were standarized for healthy men and women. Z-scores were reversed for HDL and creatinine clearence.\n2 - Mixed-effects models with a random interecept and a random linear slope, were used to calculate participants’ personal slopes (change in biomarkers per year) Each year included time, age a t baseline center in the samples mean, and a interaction term between the time and age at the baseline. For biomarkers that show a non linear trajectory, an additionally\n3 - The individual slopes for each biomarker (annual change in biomarker Z-score) wee aggregated to create a total Pace of Aging score.\nCovariates: - Alcohol &gt; 14 units. - hipertensive or diabetic medication. - pysical inactivity. - smoking status\ncarmeli, 2019"
  },
  {
    "objectID": "analysis.html#variables",
    "href": "analysis.html#variables",
    "title": "3  Data Analysis",
    "section": "3.1 Variables",
    "text": "3.1 Variables\nI will assume that for the second follow-up, the variable names are the same as those described for the first follow-up.\n\n# Data\ndata &lt;- haven::read_dta(\"data/CLSA_test sample_selected.dta\") \n\n# Variable description for the baseline study\nvar_baseline &lt;- readxl::read_excel(\"data/baseline_data_dictionaries.xlsx\",\n                           col_types = \"text\") |&gt;\n  dplyr::filter(name %in% colnames(data)) |&gt;\n  dplyr::select(-SourceTable)\n\n# Variable description for the first follow-up\nvar_follow_up1 &lt;-\n  readxl::read_excel(\"data/follow-up1_data_dictionaries_v2.xlsx\",\n             col_types = \"text\") |&gt;\n  dplyr::filter(name %in% colnames(data)) |&gt;\n  dplyr::rename(label = `label:en`,\n         question = `question:en`,\n         comment = `comment:en`)\n\nSome of the variables are labeled. I will extract the labels to can use the information later. For this I create dlabel().\n\n# Extract labels and save them in small datasets\ndlabel &lt;-  function(variable){\ndata |&gt; \n  dplyr::select({{variable}}) |&gt; \n  dplyr::mutate(lab = haven::as_factor({{variable}})) |&gt; \n  dplyr::filter (!duplicated({{variable}})) |&gt; \n  dplyr::arrange({{variable}})\n}\n\ned_label &lt;- dlabel(ED_UDR04_COM)\nsdc_label &lt;- dlabel(SDC_MRTL_COM)\ninc_tot_label &lt;- dlabel(INC_TOT_COM)\ninc_ptot_label &lt;- dlabel(INC_PTOT_COM)\nwea_label &lt;- dlabel(WEA_SVNGSVL_MCQ)\n\nThis are the variables available in the dataset:\n\ntable &lt;- rbind(var_baseline, var_follow_up1) |&gt;\n  dplyr::select(name, label, everything(), -unit, -table) |&gt;\n  dplyr::arrange(name) |&gt; \n  kableExtra::kable(caption = \"Variables in the dataset\") |&gt;\n  kableExtra::kable_classic(full_width = F) \ntable\n\n\nVariables in the dataset\n\n\nname\nlabel\nvalueType\nquestion\ncomment\n\n\n\n\nAGE_NMBR_COF1\nParticipant age at beginning of FU1\ninteger\nNA\nNA\n\n\nAGE_NMBR_COM\nAge (years)\ninteger\nNA\nCalculated: Date of interview less reported Date of Birth\n\n\nED_UDR04_COM\nHighest Level of Education - Respondent, 4 Levels\ntext\nNA\nDerived Variable\n\n\nINC_PTOT_COM\nTotal personal income\ntext\nWhat is your best estimate of your total personal income from all sources, before taxes and deductions, in the past 12 months?\nNA\n\n\nINC_TOT_COM\nTotal household income\ntext\nWhat is your best estimate of the total household income received by all household members, from all sources, before taxes and deductions, in the past 12 months?\nNA\n\n\nSDC_MRTL_COM\nMarital/partner status\ntext\nWhat is your current marital/partner status?\nNA\n\n\nSEX_ASK_COM\nSex\ntext\nAre you male or female?\nNA\n\n\nWEA_SVNGSVL_MCQ\nTotal value of savings and investments\ntext\nWhat is the approximate total value of these savings and investments?\nNA\n\n\nWEA_SVNGSVL_MCQ\nTotal value of savings and investments\ntext\nWhat is the approximate total value of these savings and investments?\nNA\n\n\nWLK_TIME_COF1\nTotal time required to complete 4mWalk (in seconds)\ndecimal\nNA\nCombination of registered times in seconds and centiseconds\n\n\nWLK_TIME_COM\nTotal time required to complete 4mWalk (in seconds)\ndecimal\nRecord time requried to perform the test\nCombination of registered times in seconds and centiseconds\n\n\nstartdate_COF1\nIn-Home Questionnaire start date& time\ndatetime\nNA\nNA\n\n\nstartdate_COM\nDate and time at start of interview\ndatetime\nNA\nNA"
  },
  {
    "objectID": "analysis.html#exploratory-data-analysis-eda",
    "href": "analysis.html#exploratory-data-analysis-eda",
    "title": "3  Data Analysis",
    "section": "3.2 Exploratory Data Analysis (EDA)",
    "text": "3.2 Exploratory Data Analysis (EDA)\n\n3.2.1 General observations\n\nIn this dataset there are are reported the baseline values (*_COM), as well as the first follow up in 2017/18 (*_COF1) and the second follow up (*_COF2), that seems to be 2019/20/21 in the data.\nData were collected between 2012 and 2021.\n\n\nsummary(data)\n\n       id        startdate_COM      startdate_COF1     startdate_COF2    \n Min.   :    6   Length:1000        Length:1000        Length:1000       \n 1st Qu.:21704   Class :character   Class :character   Class :character  \n Median :45524   Mode  :character   Mode  :character   Mode  :character  \n Mean   :44858                                                           \n 3rd Qu.:67622                                                           \n Max.   :90271                                                           \n                                                                         \n  AGE_NMBR_COM   AGE_NMBR_COF1   AGE_NMBR_COF2   SEX_ASK_COM       \n Min.   :45.00   Min.   :47.00   Min.   :50.00   Length:1000       \n 1st Qu.:55.00   1st Qu.:58.00   1st Qu.:60.00   Class :character  \n Median :63.00   Median :65.00   Median :68.00   Mode  :character  \n Mean   :63.47   Mean   :66.06   Mean   :68.44                     \n 3rd Qu.:72.00   3rd Qu.:74.00   3rd Qu.:76.00                     \n Max.   :86.00   Max.   :89.00   Max.   :91.00                     \n                 NA's   :81      NA's   :148                       \n  ED_UDR04_COM    SDC_MRTL_COM    INC_TOT_COM     INC_PTOT_COM  \n Min.   :1.000   Min.   :1.000   Min.   :1.000   Min.   :1.000  \n 1st Qu.:4.000   1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000  \n Median :4.000   Median :2.000   Median :3.000   Median :2.000  \n Mean   :3.577   Mean   :2.308   Mean   :3.494   Mean   :2.792  \n 3rd Qu.:4.000   3rd Qu.:2.000   3rd Qu.:4.000   3rd Qu.:3.000  \n Max.   :9.000   Max.   :5.000   Max.   :9.000   Max.   :9.000  \n                                                                \n WEA_SVNGSVL_MCQ  WLK_TIME_COM     WLK_TIME_COF1       WLK_TIME_COF2      \n Min.   :1.000   Min.   :-88.000   Min.   :-99999.00   Min.   :-99999.00  \n 1st Qu.:2.000   1st Qu.:  3.600   1st Qu.:     3.60   1st Qu.:-99993.00  \n Median :3.000   Median :  4.090   Median :     4.09   Median :     3.22  \n Mean   :3.116   Mean   :  4.172   Mean   : -6439.67   Mean   :-46395.00  \n 3rd Qu.:3.000   3rd Qu.:  4.683   3rd Qu.:     4.72   3rd Qu.:     4.18  \n Max.   :9.000   Max.   : 14.410   Max.   :    10.63   Max.   :    20.32  \n NA's   :66      NA's   :4         NA's   :81          NA's   :148        \n\n\n\nThe cases were NA values were reported for COF1 and COF2 were removed. The NAs for WEA_SVNGSVL_MCQ were also eliminated from the analysis.\nVariable height is missing.\n\n\ndata$startdate_COF1[data$startdate_COF1 == \"\"] &lt;- NA\ndata$startdate_COF2[data$startdate_COF2 == \"\"] &lt;- NA\n\n\ndata &lt;- data |&gt;\n  dplyr::mutate(\n    startdate_COM = as.POSIXct(startdate_COM,\n                               format = \"%Y-%m-%dT%H:%M:%OS\"), # convert dates\n    startdate_COF1 = as.POSIXct(startdate_COF1,\n                                format = \"%Y-%m-%dT%H:%M:%OS\"),\n    startdate_COF2 = as.POSIXct(startdate_COF2,\n                                format = \"%Y-%m-%dT%H:%M:%OS\")\n  ) |&gt;\n  dplyr::filter( \n                is.na(data$startdate_COF1) == FALSE,\n                is.na(data$startdate_COF2) == FALSE,\n                is.na(data$WEA_SVNGSVL_MCQ) == FALSE) # remove NAs\n\n\n\n3.2.2 Data wrangling\n\nThe dataset is divided in subtables to make it easier to use.\nThe variable Walking time is converted to Walking speed.\nFollowing Stringhini et al. (2018), the ages have been reduced from 45 to 90.\n\n\n# Socieconomic variables sub-table\nsoc_vars &lt;- data |&gt;\n  haven::zap_labels() |&gt; # I have already saved the labels in tables\n  tidyr::pivot_longer(col = c(9, 11, 12, 13),\n                      values_to = \"SOC_VALS\",\n                      names_to = \"SOC_VARS\") |&gt;\n  dplyr::filter(!SOC_VALS &lt; 0) |&gt;\n  dplyr::select(id, SOC_VALS, SOC_VARS)\n\n# Gender sub-table\ngender &lt;- data |&gt;\n  haven::zap_labels() |&gt;\n  dplyr::select(id, SEX_ASK_COM)\n\n# Walking speed sub-table\nwlk_time &lt;- data |&gt;\n  haven::zap_labels() |&gt;\n  tidyr::pivot_longer(14:16, values_to = \"WLK_TIME\", names_to = \"COHORT\") |&gt;\n  dplyr::filter(!WLK_TIME &lt; 0) |&gt;\n  tidyr::separate(COHORT, into = c(\"A\", \"B\", \"COHORT\"), sep = \"_\") |&gt;\n  dplyr::select(id, COHORT, WLK_TIME)\n\n# Age sub-table\nage &lt;- data |&gt;\n  haven::zap_labels() |&gt;\n  pivot_longer(5:7,\n               values_to = \"AGE_VALS\", names_to = \"AGE_VARS\")  |&gt;\n  dplyr::select(id, AGE_VALS, AGE_VARS) |&gt;\n  dplyr::filter(!is.na(AGE_VALS)) |&gt;\n  tidyr::separate(AGE_VARS, into = c(\"A\", \"B\", \"COHORT\"), sep = \"_\") |&gt;\n  dplyr::select(id, COHORT, AGE_VALS)\n\n# Final table\ndata_by_cohort &lt;-  dplyr::left_join(age, wlk_time)\ndata_plot &lt;- dplyr::left_join(data_by_cohort, soc_vars)\n\n# Convert Walking time to Walking speed\ndata_plot &lt;- data_plot |&gt;\n  dplyr::mutate(WLK_TIME = (4 / WLK_TIME)) |&gt;\n  dplyr::filter(AGE_VALS &gt;= 45,\n                AGE_VALS &lt;= 90)\n\n\n\n3.2.3 Demographic variables\n\n  data_plot |&gt;\n    dplyr::left_join(gender) |&gt; \n    select(id, AGE_VALS, SEX_ASK_COM) |&gt;\n    filter (!duplicated(id)) |&gt;\n    ggplot() +\n    scale_fill_brewer() +\n    geom_histogram(\n      aes(AGE_VALS),\n      bins = 10,\n      color = \"#e9ecef\",\n      alpha = 0.6,\n      position = 'identity'\n    ) +\n    scale_x_continuous(breaks = round(seq(45,90, by = 5),1)) +\n    xlab(\"Age\") +\n    facet_wrap(vars(SEX_ASK_COM)) +\n    theme_minimal()\n\n\n\n\nComments:\n\nThere are fewer observations for older ages.\nThere are 824 observations in the dataset. 48.7 % are men and 51.3 % are women.\n\n\n\n3.2.4 Socioeconomic Variables\n\ndata_boxplot &lt;-  data_plot |&gt;\n  dplyr::filter(SOC_VARS == 'ED_UDR04_COM') |&gt;\n  dplyr::left_join(ed_label, by = dplyr::join_by(SOC_VALS == ED_UDR04_COM))\n# Number of points by category\nobs1 &lt;- data_boxplot |&gt; dplyr::count(lab)\n\ndata_boxplot |&gt;\n  ggplot(aes(x = as.factor(lab), y = WLK_TIME)) +\n  geom_quasirandom(alpha = 0.3, color = \"deepskyblue3\") +\n  geom_boxplot(fill = 'transparent') +\n  coord_flip() +\n  labs(title = \"Education\", subtitle = \"ED_UDR04_COM\") +\n  xlab(\"\") +\n  ylab(\"Walking speed not conditioned by height (m/s)\") +\n  geom_text(data = obs1, aes(y = 2.4,\n                            label = paste0(\"(\", n, \")\")),\n            size = 2.5) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nConsidering that we don’t have height values to associate with walking speed, we will solely make comments about the amount of observations in each category\nComments:\n\n79.7% of the participants hold a post-secondary degree/diploma.\n50% of the participants have Total Value of Saving and Investments between $100,000 and $1 million dollars.\nHowever, the Total Household Income is more homogeneous among its categories, being $50,000 or more, but less than $100,000 the maximum value reported (32%). This could indicate that some study participants with a post-secondary degree and $100,000 - $1 million dollars of savings and investments belongs to more than one Total Household Income category. More analysis should be carry out to confirm this.\nData reported as ‘refused’ or ‘No answer’ should be removed of the analysis.\n\n\n\n3.2.5 Walking Speed as function of age.\n\nObervations are not independent\nOutcome variable: walking speed\n\nFirst, let’s visualize the data. ggplot2 function geom_smooth() adjusts the data to walking-speed ~ s(age, bs = \"cs\").\n\ndata_plot |&gt;\n  ggplot(aes(y = WLK_TIME,\n             x = AGE_VALS)) +\n  geom_point(alpha = 0.2, color = 'gray') +\n  geom_smooth(color = \"deepskyblue3\", fill = \"deepskyblue2\") +\n  xlab(\"Age\") +\n  ylab(\"Walking speed not conditioned by height (m/s)\") +\n  theme_minimal()\n\n\n\n\nIf we fit this basic first model:\n\nmodel &lt;- gam(data = data_plot, WLK_TIME ~ s(AGE_VALS))\nsummary(model)\n\n\nFamily: gaussian \nLink function: identity \n\nFormula:\nWLK_TIME ~ s(AGE_VALS)\n\nParametric coefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) 0.978068   0.001996   490.1   &lt;2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nApproximate significance of smooth terms:\n              edf Ref.df     F p-value    \ns(AGE_VALS) 4.773  5.843 172.1  &lt;2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nR-sq.(adj) =  0.109   Deviance explained = 10.9%\nGCV = 0.032821  Scale est. = 0.032798  n = 8236\n\n\n\nplot(model) \n\n\n\n\nDespite we don’t have height values, it is possible to capture a decreasing trend of the walking speed with the age.\n\ngam.check(model)\n\n\n\n\n\nMethod: GCV   Optimizer: magic\nSmoothing parameter selection converged after 4 iterations.\nThe RMS GCV score gradient at convergence was 4.021007e-07 .\nThe Hessian was positive definite.\nModel rank =  10 / 10 \n\nBasis dimension (k) checking results. Low p-value (k-index&lt;1) may\nindicate that k is too low, especially if edf is close to k'.\n\n              k'  edf k-index p-value\ns(AGE_VALS) 9.00 4.77    0.99     0.2\n\n\nTo be continued…\nIf we split the data by gender:\n\ndata_plot |&gt;\n  dplyr::left_join(gender) |&gt;\n  filter(!WLK_TIME &lt; 0) |&gt; # outlier: walking speed around -70 removed\n  ggplot(aes(y = WLK_TIME,\n             x = AGE_VALS)) +\n  geom_point(alpha = 0.2, color = 'gray') +\n  geom_smooth(aes(color = SEX_ASK_COM, fill = SEX_ASK_COM)) +\n  facet_wrap(vars(SEX_ASK_COM)) +\n  xlab(\"Age\") +\n  ylab(\"Walking speed not conditioned by height (m/s)\") +\n  labs(fill = \"Gender\", color = \"Gender\") +\n  theme_minimal()\n\n\n\n\nNext steps:\n\nAdd age, height, and the socioeconomic variables as fixed effects using a generalized additive mixed model (GAMM).\nThis could be performed for one socioeconomic variable at a time or to all the variables at the same time.\nIn Stringhini et al. (2018), study is used as a random effect at the intercept and age slope, but in that article, multiple studies from different countries were used.\nIn this case, we could try using id as a random effect."
  },
  {
    "objectID": "analysis.html#removed",
    "href": "analysis.html#removed",
    "title": "3  Data Analysis",
    "section": "3.3 Removed",
    "text": "3.3 Removed\n\nsocvars &lt;- data |&gt; \n  select(starts_with(\"INC\"), ED_UDR04_COM, WEA_SVNGSVL_MCQ, SDC_MRTL_COM)\n\nchart.Correlation(socvars, histogram=TRUE, pch=19)\n\n\n\n\n\ndata_plot |&gt; \nggplot( aes(x = as.factor(SOC_VALS), y = WLK_TIME)) +\n  geom_boxplot(aes(fill = fct_relevel(COHORT, \"COM\", \"COF1\", \"COF2\"))) +\n  facet_wrap(vars(SOC_VARS), scales = \"free_x\" ) +\n  labs(fill = \"COHORT\") +\n  theme_minimal()\n\n\n\n\n\n# library(gamm4)\n# \n# model1 &lt;- gamm(WLK_TIME ~ s(AGE_VALS) + INC_TOT_COM,\n#                data = data_plot)\n# \n# model2 &lt;- gamm(WLK_TIME ~ s(AGE_VALS) + INC_TOT_COM + \n#                ED_UDR04_COM + WEA_SVNGSVL_MCQ,\n#                random = ~ (1 | id),\n#                data = data_plot)\n# \n# model3 &lt;- gamm(WLK_TIME ~ s(AGE_VALS, k = 4) +\n#                 s(INC_TOT_COM, k=4) +\n#                 s(ED_UDR04_COM, k=4) +\n#                 s(WEA_SVNGSVL_MCQ, k=4),\n#                 random = ~ (1 | id)\n#                 data = data_soc)\n# \n# \n# \n# summary(model1)\n# summary(model2)\n# summary(model3)\n\n\n\n\n\nStringhini, Silvia, Cristian Carmeli, Markus Jokela, Mauricio Avendaño, Cathal McCrory, Angelo d’Errico, Murielle Bochud, et al. 2018. “Socioeconomic Status, Non-Communicable Disease Risk Factors, and Walking Speed in Older Adults: Multi-Cohort Population Based Study.” Bmj 360."
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "Everitt, BS. 1998. “Analysis of Longitudinal Data: Beyond\nMANOVA.” The British Journal of Psychiatry 172 (1):\n7–10.\n\n\nStringhini, Silvia, Cristian Carmeli, Markus Jokela, Mauricio Avendaño,\nCathal McCrory, Angelo d’Errico, Murielle Bochud, et al. 2018.\n“Socioeconomic Status, Non-Communicable Disease Risk Factors, and\nWalking Speed in Older Adults: Multi-Cohort Population Based\nStudy.” Bmj 360.\n\n\nTwisk, Jos W. R. 2013. Applied Longitudinal Data Analysis for\nEpidemiology: A Practical Guide. 2nd ed. Cambridge University\nPress."
  }
]