<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Notes on Longitudinal Data Analysis for Epidemiology - 1&nbsp; State of the Art - Statistics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./papers.html" rel="next">
<link href="./index.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./intro.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">State of the Art - Statistics</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Notes on Longitudinal Data Analysis for Epidemiology</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">State of the Art - Statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./papers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Scientific articles</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#longitudinal-studies" id="toc-longitudinal-studies" class="nav-link active" data-scroll-target="#longitudinal-studies"><span class="header-section-number">1.1</span> Longitudinal studies</a></li>
  <li><a href="#cohort-studies" id="toc-cohort-studies" class="nav-link" data-scroll-target="#cohort-studies"><span class="header-section-number">1.2</span> Cohort studies</a>
  <ul class="collapse">
  <li><a href="#observational-cohort-studies" id="toc-observational-cohort-studies" class="nav-link" data-scroll-target="#observational-cohort-studies"><span class="header-section-number">1.2.1</span> Observational cohort studies</a></li>
  <li><a href="#experimental-cohort-studies-clinical-trials" id="toc-experimental-cohort-studies-clinical-trials" class="nav-link" data-scroll-target="#experimental-cohort-studies-clinical-trials"><span class="header-section-number">1.2.2</span> Experimental cohort studies (<strong>clinical trials</strong>)</a></li>
  </ul></li>
  <li><a href="#one-continous-outcome-variable-y-is-repeatedly-measured-over-time" id="toc-one-continous-outcome-variable-y-is-repeatedly-measured-over-time" class="nav-link" data-scroll-target="#one-continous-outcome-variable-y-is-repeatedly-measured-over-time"><span class="header-section-number">1.3</span> One continous outcome variable Y is repeatedly measured over time</a>
  <ul class="collapse">
  <li><a href="#two-measurements" id="toc-two-measurements" class="nav-link" data-scroll-target="#two-measurements"><span class="header-section-number">1.3.1</span> Two measurements</a></li>
  <li><a href="#more-than-two-measurements" id="toc-more-than-two-measurements" class="nav-link" data-scroll-target="#more-than-two-measurements"><span class="header-section-number">1.3.2</span> More than two measurements</a></li>
  <li><a href="#multivariate-analysis-of-variance-manova-for-repeated-measurements" id="toc-multivariate-analysis-of-variance-manova-for-repeated-measurements" class="nav-link" data-scroll-target="#multivariate-analysis-of-variance-manova-for-repeated-measurements"><span class="header-section-number">1.3.3</span> Multivariate analysis of variance (MANOVA) for repeated measurements</a></li>
  </ul></li>
  <li><a href="#one-continuous-outcome-variable-y-is-compared-between-different-groups." id="toc-one-continuous-outcome-variable-y-is-compared-between-different-groups." class="nav-link" data-scroll-target="#one-continuous-outcome-variable-y-is-compared-between-different-groups."><span class="header-section-number">1.4</span> One continuous outcome variable Y is compared between different groups.</a></li>
  <li><a href="#continuous-outcome-variable-and-several-covariates" id="toc-continuous-outcome-variable-and-several-covariates" class="nav-link" data-scroll-target="#continuous-outcome-variable-and-several-covariates"><span class="header-section-number">1.5</span> Continuous outcome variable and several covariates</a>
  <ul class="collapse">
  <li><a href="#traditional-methods." id="toc-traditional-methods." class="nav-link" data-scroll-target="#traditional-methods."><span class="header-section-number">1.5.1</span> Traditional methods.</a></li>
  <li><a href="#new-methods." id="toc-new-methods." class="nav-link" data-scroll-target="#new-methods."><span class="header-section-number">1.5.2</span> New methods.</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">State of the Art - Statistics</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>All this section is based on <span class="citation" data-cites="twisk2013">Twisk (<a href="references.html#ref-twisk2013" role="doc-biblioref">2013</a>)</span></p>
<section id="longitudinal-studies" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="longitudinal-studies"><span class="header-section-number">1.1</span> Longitudinal studies</h2>
<blockquote class="blockquote">
<p>Longitudinal studies are defined as studies in which the outcome variable is repeateadly measured; i.e.&nbsp;the outcome variable is measured in the same subject on several occasions. – Extracted from <span class="citation" data-cites="twisk2013">Twisk (<a href="references.html#ref-twisk2013" role="doc-biblioref">2013</a>)</span></p>
</blockquote>
<p>Characteristics:</p>
<ul>
<li><p>Observations of one subject over time are not independent of each other.</p></li>
<li><p>Statistics should consider that repeated observations of each subject are correlated.</p></li>
<li><p>This studies bring the illusion than are solving causality but only we can try temporality.</p></li>
</ul>
<table class="table">
<caption>Statistical notation</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Notation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">number of subjects</td>
<td style="text-align: left;"><code>i = 1 to N</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">number of covariates</td>
<td style="text-align: left;"><code>j = 1 to J</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">number of times a particular subject is measured</td>
<td style="text-align: left;"><code>t = 1 to T</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">outcome variable</td>
<td style="text-align: left;"><code>Y</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">covariates</td>
<td style="text-align: left;"><code>X</code></td>
</tr>
</tbody>
</table>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="classification.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Image extracted from <span class="citation" data-cites="twisk2013">Twisk (<a href="references.html#ref-twisk2013" role="doc-biblioref">2013</a>)</span></figcaption>
</figure>
</div>
</section>
<section id="cohort-studies" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="cohort-studies"><span class="header-section-number">1.2</span> Cohort studies</h2>
<section id="observational-cohort-studies" class="level3" data-number="1.2.1">
<h3 data-number="1.2.1" class="anchored" data-anchor-id="observational-cohort-studies"><span class="header-section-number">1.2.1</span> Observational cohort studies</h3>
<p>The question of probable causality remains unanswered.</p>
<p>can be divided into:<br>
* <strong>prospective</strong>. * The only one that can be characterized as longitudinal.<br>
* Analyze the longitudinal development of a certain characteristic over time (growth or deterioration).<br>
* <strong>tracking</strong>: “stability” of a certain characteristic over time.</p>
<ul>
<li><strong>retrospective</strong>.</li>
<li><strong>cross-sectional</strong>.</li>
</ul>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: left;">Term</th>
<th style="text-align: left;">Definition</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>age</code></td>
<td style="text-align: left;">time from date of birth to date of measurement</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>period</code></td>
<td style="text-align: left;">time or moment at which the measurement is taken</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>birth cohort</code></td>
<td style="text-align: left;">group of subjects born in the same year</td>
</tr>
</tbody>
</table>
<section id="confounding-effects" class="level4" data-number="1.2.1.1">
<h4 data-number="1.2.1.1" class="anchored" data-anchor-id="confounding-effects"><span class="header-section-number">1.2.1.1</span> Confounding Effects</h4>
<p><em>age</em>, <em>period</em> and <em>cohort</em> effects could produce variations in the results.</p>
<ul>
<li><strong>period effect</strong>.<br>
If we measure physical activity during summers, it is likely that we can have more physical activity a hot summer than a rainy one. This can produce a bias in the age trend.</li>
<li><strong>cohort effect</strong>. If we want to unify results for the same age for cohorts that start at different ages, we will find that the trend is much flatter than the effects of the cohorts in isolation.</li>
</ul>
<p>One way to avoid the bias is to use an approach called <em>multiple longitudinal design</em> Basically, multiple longitudinal design is to work with more than one cohort at the same time. If all the cohorts show a defined pattern for a particular measure in time, we will be able to detect it with this approach.</p>
<ul>
<li><strong>Test or learning effect</strong>. Individuals start performing better with exposure.</li>
<li><strong>Low reproducibility of the measurements</strong>. Inter-period correlation coefficients (IPCs) (van ’t Hofand Kowalski, 1979)</li>
</ul>
</section>
</section>
<section id="experimental-cohort-studies-clinical-trials" class="level3" data-number="1.2.2">
<h3 data-number="1.2.2" class="anchored" data-anchor-id="experimental-cohort-studies-clinical-trials"><span class="header-section-number">1.2.2</span> Experimental cohort studies (<strong>clinical trials</strong>)</h3>
<ul>
<li>There are prospective (ie longitudinal).</li>
<li>The outcome variable Y is measured at least twice (the classical “pre-test,” “post-test” design).</li>
<li>The issue of causality can be covered</li>
</ul>
</section>
</section>
<section id="one-continous-outcome-variable-y-is-repeatedly-measured-over-time" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="one-continous-outcome-variable-y-is-repeatedly-measured-over-time"><span class="header-section-number">1.3</span> One continous outcome variable Y is repeatedly measured over time</h2>
<section id="two-measurements" class="level3" data-number="1.3.1">
<h3 data-number="1.3.1" class="anchored" data-anchor-id="two-measurements"><span class="header-section-number">1.3.1</span> Two measurements</h3>
<section id="parametric-paired-t-test" class="level4" data-number="1.3.1.1">
<h4 data-number="1.3.1.1" class="anchored" data-anchor-id="parametric-paired-t-test"><span class="header-section-number">1.3.1.1</span> Parametric: paired t-test</h4>
<blockquote class="blockquote">
<p>Is there a difference in the outcome variable <code>Y</code> between <code>t = 1</code> and <code>t = 2</code>?</p>
</blockquote>
<p>The <strong>paired t-test</strong> is used to test the hypothesis that the mean difference between <code>Yt1</code> and <code>Yt2</code> equals zero.</p>
<ul>
<li><p>Observations within one individual are dependent on each other.</p></li>
<li><p>Use if the number of subjects is quite large (say above 25).</p></li>
</ul>
<section id="assumptions" class="level5" data-number="1.3.1.1.1">
<h5 data-number="1.3.1.1.1" class="anchored" data-anchor-id="assumptions"><span class="header-section-number">1.3.1.1.1</span> Assumptions</h5>
<p>1 - The observations of different subjects are independent and;<br>
2 - The differences between the two measurements are approximately normally distributed.</p>
</section>
</section>
<section id="non-parametric-wilcoxon-signed-rank-sum" class="level4" data-number="1.3.1.2">
<h4 data-number="1.3.1.2" class="anchored" data-anchor-id="non-parametric-wilcoxon-signed-rank-sum"><span class="header-section-number">1.3.1.2</span> Non-parametric: (Wilcoxon) signed rank sum</h4>
<p>Doesn’t assume any distribution.</p>
</section>
</section>
<section id="more-than-two-measurements" class="level3" data-number="1.3.2">
<h3 data-number="1.3.2" class="anchored" data-anchor-id="more-than-two-measurements"><span class="header-section-number">1.3.2</span> More than two measurements</h3>
<blockquote class="blockquote">
<p>Does the outcome variable <code>Y</code> change over time?</p>
</blockquote>
</section>
<section id="multivariate-analysis-of-variance-manova-for-repeated-measurements" class="level3" data-number="1.3.3">
<h3 data-number="1.3.3" class="anchored" data-anchor-id="multivariate-analysis-of-variance-manova-for-repeated-measurements"><span class="header-section-number">1.3.3</span> Multivariate analysis of variance (MANOVA) for repeated measurements</h3>
<p>1 - Observations of different subjects. at each of the repeated measurements need to be independent; and. 2 - The observations need to be multivariate normally distributed, which is comparable but slightly more restrictive than the requirement that the differences between subsequent measurements be normally distributed.</p>
<section id="anova-univariate-vs.-manova-multivariate" class="level4" data-number="1.3.3.1">
<h4 data-number="1.3.3.1" class="anchored" data-anchor-id="anova-univariate-vs.-manova-multivariate"><span class="header-section-number">1.3.3.1</span> ANOVA (univariate) vs.&nbsp;MANOVA (multivariate)</h4>
<p>To perform an ANOVA there is one extra assumption with 2 parts:</p>
<p><strong>Sphericity assumption (epsilon coefficient)</strong></p>
<p>3 - All correlations in outcome variable Y between repeated measurements are equal, irrespective of the time interval between the measurements.</p>
<p>4 - The variances of outcome variable Y are the same at each of the repeated measurements.</p>
<p><strong>Which approach should be used?</strong> If the assumptions are met, ANOVA is more powerful for smaller samples:</p>
<blockquote class="blockquote">
<p>“The restriction of the assumption of sphericity (i.e.&nbsp;equal correlations and equal variances over time) leads to an increase in degrees of freedom, i.e.&nbsp;an increase in power for the “univariate” approach. This increase in power becomes more important when the sample size becomes smaller. Historically, the “multivariate” approach was developed later than the “univariate” approach, especially for situations when the assumption of sphericity does not hold. So, one could argue that <strong>when the assumption of sphericity is violated,</strong> <strong>the “multivariate” approach should be used</strong>.</p>
</blockquote>
<p>– Extracted from <span class="citation" data-cites="twisk2013">Twisk (<a href="references.html#ref-twisk2013" role="doc-biblioref">2013</a>)</span></p>
<p>MAMOVA in R - https://www.appsilon.com/post/manova-in-r</p>
</section>
</section>
</section>
<section id="one-continuous-outcome-variable-y-is-compared-between-different-groups." class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="one-continuous-outcome-variable-y-is-compared-between-different-groups."><span class="header-section-number">1.4</span> One continuous outcome variable Y is compared between different groups.</h2>
<p>This design is known as the “one-within, one-between” design. Time is the within-subject factor and the group variable is the between-subjects factor.</p>
<blockquote class="blockquote">
<p>Is there a difference in change over time for outcome variable Y between two or more groups?</p>
</blockquote>
<ul>
<li><p>This question can also be answered with MANOVA for repeated measurements if it is assumed that the covariance matrices of the different groups that are compared to each other are homogeneous (independent sample <code>t-test</code>).</p></li>
<li><p>Apparently, MANOVA could be biased when you have a lot of drop-offs in the study (<span class="citation" data-cites="biasmanova">Everitt (<a href="references.html#ref-biasmanova" role="doc-biblioref">1998</a>)</span>).</p></li>
</ul>
</section>
<section id="continuous-outcome-variable-and-several-covariates" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="continuous-outcome-variable-and-several-covariates"><span class="header-section-number">1.5</span> Continuous outcome variable and several covariates</h2>
<p>(which can be either continuous, dichotomous, or categorical)</p>
<blockquote class="blockquote">
<p><strong>“traditional” methods</strong> tried to reduce the statistical longitudinal problem into a <strong>cross-sectional problem</strong>.</p>
</blockquote>
<section id="traditional-methods." class="level3" data-number="1.5.1">
<h3 data-number="1.5.1" class="anchored" data-anchor-id="traditional-methods."><span class="header-section-number">1.5.1</span> Traditional methods.</h3>
<ul>
<li>Analysis of the relationships between changes in different parameters between two points in time. (but, you are not using all the data)</li>
<li>Use individual regression lines with time.</li>
</ul>
</section>
<section id="new-methods." class="level3" data-number="1.5.2">
<h3 data-number="1.5.2" class="anchored" data-anchor-id="new-methods."><span class="header-section-number">1.5.2</span> New methods.</h3>
<p>With the development of (new) statistical techniques, such as:</p>
<ol type="1">
<li><p>Generalized estimating equations (GEE) analysis and;</p></li>
<li><p>Mixed-model analysis,</p></li>
</ol>
<p>it has become possible to analyze longitudinal relationships using all available longitudinal data, without summarizing the longitudinal development of each subject into one value.</p>
<p>Crippa (2022) A review of Longitudinal Data Analysis in R: https://rpubs.com/alecri/review_longitudinal</p>


<div id="refs" class="references csl-bib-body hanging-indent" role="list" style="display: none">
<div id="ref-biasmanova" class="csl-entry" role="listitem">
Everitt, BS. 1998. <span>“Analysis of Longitudinal Data: Beyond MANOVA.”</span> <em>The British Journal of Psychiatry</em> 172 (1): 7–10.
</div>
<div id="ref-twisk2013" class="csl-entry" role="listitem">
Twisk, Jos W. R. 2013. <em>Applied Longitudinal Data Analysis for Epidemiology: A Practical Guide</em>. 2nd ed. Cambridge University Press.
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./index.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Welcome</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./papers.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Scientific articles</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>